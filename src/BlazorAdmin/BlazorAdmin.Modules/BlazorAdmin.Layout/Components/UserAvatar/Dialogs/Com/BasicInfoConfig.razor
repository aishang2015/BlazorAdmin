@using BlazorAdmin.Servers.Core.Helper
@using BlazorAdmin.Servers.Core.States
<div class="d-flex flex-column pa-2" style="width:100%;height:100%;overflow:auto">
    <MudText Typo="Typo.h6" Class="mb-4">基本设置</MudText>

    <MudText Typo="Typo.subtitle1" Class="mb-4">账号信息</MudText>

    <MudPaper Outlined="true" Class="pa-2">
        <MudList T="string" DisablePadding="true">
            <MudListItem>
                <div class="d-flex align-center">
                    <MudText>头像</MudText>
                    <MudSpacer />
                    <MudFileUpload Class="flex-none" T="IBrowserFile" FilesChanged="UploadFiles" Accept=".png, .jpg">
                        <ActivatorContent>
                            <MudIconButton>
                                @if (string.IsNullOrEmpty(_user.Avatar))
                                {
                                    <MudAvatar Color="Color.Primary">
                                        @_user.RealName.First()
                                    </MudAvatar>
                                }
                                else
                                {
                                    <MudAvatar>
                                        <MudImage Src="@("Avatars/" + _user.Avatar)"></MudImage>
                                    </MudAvatar>
                                }
                            </MudIconButton>
                        </ActivatorContent>
                    </MudFileUpload>
                </div>
            </MudListItem>
            <MudDivider />
            <MudListItem>
                <div class="d-flex align-center">
                    <MudText>用户名</MudText>
                    <MudSpacer />
                    @if (!_isEditUserName)
                    {
                        <MudText @onclick="EditUserName">@_user.Name</MudText>
                    }
                    else
                    {
                        <MudTextField @bind-Value="_editUserName" Immediate="true" @onblur="EditUserNameBlur"
                                    Margin="Margin.Dense" Variant="Variant.Outlined" AutoFocus="true"></MudTextField>
                    }
                </div>
            </MudListItem>
            <MudDivider />
            <MudListItem>
                <div class="d-flex align-center">
                    <MudText>姓名</MudText>
                    <MudSpacer />
                    @if (!_isEditRealName)
                    {
                        <MudText @onclick="EditRealName">@_user.RealName</MudText>
                    }
                    else
                    {
                        <MudTextField @bind-Value="_editRealName" Immediate="true" @onblur="EditRealNameBlur"
                                    Margin="Margin.Dense" Variant="Variant.Outlined" AutoFocus="true"></MudTextField>
                    }
                </div>
            </MudListItem>
            <MudDivider />
            <MudListItem>
                <div class="d-flex align-center">
                    <MudText>邮箱</MudText>
                    <MudSpacer />
                    @if (!_isEditEmail)
                    {
                        <MudText @onclick="EditEmail">@(_user.Email ?? "未设置")</MudText>
                    }
                    else
                    {
                        <MudTextField @bind-Value="_editEmail" Immediate="true" @onblur="EditEmailBlur"
                                    Margin="Margin.Dense" Variant="Variant.Outlined" AutoFocus="true"></MudTextField>
                    }
                </div>
            </MudListItem>
            <MudDivider />
            <MudListItem>
                <div class="d-flex align-center">
                    <MudText>手机号</MudText>
                    <MudSpacer />
                    @if (!_isEditPhone)
                    {
                        <MudText @onclick="EditPhone">@(_user.PhoneNumber ?? "未设置")</MudText>
                    }
                    else
                    {
                        <MudTextField @bind-Value="_editPhone" Immediate="true" @onblur="EditPhoneBlur"
                                    Margin="Margin.Dense" Variant="Variant.Outlined" AutoFocus="true"></MudTextField>
                    }
                </div>
            </MudListItem>
            <MudDivider />
            <MudListItem>
                <div class="d-flex align-center">
                    <MudText>密码</MudText>
                    <MudSpacer></MudSpacer>
                    <MudButton Variant="Variant.Outlined" Color="Color.Primary" OnClick="ChangePwd">修改</MudButton>
                </div>
            </MudListItem>
        </MudList>
    </MudPaper>
</div>